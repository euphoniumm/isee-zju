#include <iostream>
#include "AES_CMAC.hpp"

// 6bc1bee2 2e409f96 e93d7e11 7393172a ae2d8a57 1e03ac9c 9eb76fac 45af8e51 30c81c46 a35ce411 
// e5fbc119 1a0a52ef f69f2445 df4f9b17 ad2b417b e66c3710

std::vector<unsigned char> in = { 0x49,0x6e,0x66,0x6f,0x72,0x6d,0x61,0x74,0x69,
								0x6f,0x6e,0x20,0x53,0x65,0x63,0x75,0x72,0x69,
								0x74,0x79,0x20,0x69,0x73,0x20,0x61,0x20,0x6d,
								0x75,0x6c,0x74,0x69,0x64,0x69,0x73,0x63,0x69,
								0x70,0x6c,0x69,0x6e,0x61,0x72,0x79,0x61,0x72,
								0x65,0x61,0x20,0x6f,0x66,0x20,0x73,0x74,0x75,
								0x64,0x79,0x20,0x61,0x6e,0x64,0x20,0x70,0x72,
								0x6f,0x66,0x65,0x73,0x73,0x69,0x6f,0x6e,0x61,
								0x6c,0x20,0x61,0x63,0x74,0x69,0x76,0x69,0x74,
								0x79, 0x20,0x77,0x68,0x69,0x63,0x68,0x20,0x69,
								0x73,0x20,0x63,0x6f,0x6e,0x63,0x65,0x72,0x6e,
								0x65,0x64,0x20, 0x77,0x69,0x74,0x68,0x20,0x74,
								0x68,0x65,0x20,0x64,0x65,0x76,0x65,0x6c,0x6f,
								0x70,0x6d,0x65,0x6e,0x74,0x61,0x6e,0x64,0x20,
								0x69,0x6d,0x70,0x6c,0x65,0x6d,0x65,0x6e,0x74,
								0x61,0x74,0x69,0x6f,0x6e,0x20,0x6f,0x66,0x20,
								0x73,0x65,0x63,0x75,0x72,0x69,0x74,0x79,0x20,
								0x6d,0x65,0x68,0x61,0x6e,0x69,0x73,0x6d,0x73,
								0x20,0x6f ,0x66,0x20,0x61,0x6c,0x6c,0x20,0x61,
								0x76,0x61,0x69,0x6c,0x61,0x62,0x6c,0x65,0x20,
								0x74,0x79,0x70,0x65,0x73,0x20,0x74,0x6f,0x20,
								0x6b,0x65,0x65,0x70,0x69,0x6e,0x66,0x6f,0x72,
								0x6d,0x61,0x74,0x69,0x6f,0x6e,0x20,0x69,0x6e,
								0x20,0x61,0x6c,0x6c,0x20,0x69,0x74,0x73,0x20,
								0x6c,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x73,
								0x20 ,0x61,0x6e,0x64,0x2c,0x20,0x63,0x6f,0x6e,
								0x73,0x65,0x71,0x75,0x65,0x6e,0x74,0x6c,0x79,
								0x2c,0x20,0x69,0x6e,0x66,0x6f,0x72,0x6d ,0x61,
								0x74,0x69,0x6f,0x6e,0x20,0x73,0x79,0x73,0x74,
								0x65,0x6d,0x73,0x2c,0x20,0x77,0x68,0x65,0x72,
								0x65,0x69,0x6e,0x66,0x6f,0x72,0x6d,0x61,0x74,
								0x69 ,0x6f ,0x6e ,0x20 ,0x69, 0x73, 0x20 ,0x63,
								0x72 ,0x65 ,0x61 ,0x74 ,0x65 ,0x64 ,0x2c ,0x20 ,0x70 ,0x72,
								0x6f ,0x63 ,0x65 ,0x73 ,0x73 ,0x65 ,0x64 ,0x2c ,0x20,
								0x73 ,0x74 ,0x6f ,0x72 ,0x65 ,0x64 ,0x2c ,0x20 ,0x74 ,0x72,
								0x61 ,0x6e ,0x73 ,0x6d ,0x69 ,0x74 ,0x74 ,0x65 ,0x64 ,0x20,
								0x61 ,0x6e ,0x64 ,0x20 ,0x64 ,0x65 ,0x73 ,0x74 ,0x72 ,0x6f,
								0x79 ,0x65 ,0x64 ,0x2c ,0x20 ,0x66 ,0x72 ,0x65 ,0x65 ,0x20,
								0x66 ,0x72 ,0x6f ,0x6d ,0x74 ,0x68 ,0x72 ,0x65 ,0x61 ,0x74,
								0x73 ,0x2e ,0x20 ,0x54 ,0x68 ,0x69 ,0x73 ,0x20 ,0x70 ,0x72,
								0x6f ,0x6a ,0x65 ,0x63 ,0x74 ,0x20 ,0x69 ,0x73 ,0x20 ,0x66,
								0x69 ,0x6e ,0x69 ,0x73 ,0x68 ,0x65 ,0x64 ,0x20 ,0x62 ,0x79,
								0x20 ,0x5a ,0x48 ,0x41 ,0x4e ,0x47 ,0x51 ,0x49 ,0x4e ,0x47,
								0x4d ,0x49 ,0x4e ,0x47 };


std::vector<unsigned char> in1;

// 2b7e1516 28aed2a6 abf71588 09cf4f3c
const std::vector<unsigned char> KEY = {
0x5f,0x20, 0x97,0x52,0x94,0xed,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 };

int main(int argc, char* argv[])
{
	AES cipher(AESKeyLength::AES_128);
	AesCmac calculator(cipher, KEY);

	std::vector<byte> cmac_tag = calculator.generateCmac(in);

	printf("CMAC TAG: ");
	for (auto b : cmac_tag)
	{
		printf("%02X", b);
	}
	printf("\n");
}